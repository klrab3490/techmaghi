<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Phone Number Combinations</title>
        <script src="https://cdn.tailwindcss.com"></script>
    </head>
    <body class="bg-gray-50 min-h-screen flex flex-col items-center justify-center">
        <div class="w-full max-w-md bg-white rounded-lg shadow-lg p-8 mt-8">
            <a href="index.html" class="text-blue-600 hover:underline mb-4 inline-block">&larr; Back</a>
            <h1 class="text-2xl font-bold mb-6 text-center">Phone Number Combinations</h1>
            <form id="phoneNumberForm" class="space-y-4">
                <label for="inputString" class="block text-gray-700 font-medium">Enter digits (2-9) separated by spaces:</label>
                <input type="text" id="inputString" name="inputString" required
                    class="w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-400">
                <label for="region" class="block text-gray-700 font-medium">Select region:</label>
                <select id="region" name="region" required
                    class="w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-400">
                    <option value="">-- Select Region --</option>
                    <option value="us">United States</option>
                    <option value="in">India</option>
                    <option value="uk">United Kingdom</option>
                </select>
                <button type="submit"
                    class="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700 transition">Find Combinations</button>
            </form>
            <div id="result" class="mt-6 text-gray-800"></div>
        </div>
        
        <script>
            function generateMobileNumbersFromGiven(partialDigits, region) {
                const regionRules = {
                    us: { length: 10, startPattern: /^[2-9]/ },
                    in: { length: 10, startPattern: /^[6-9]/ },
                    uk: { length: 11, startPattern: /^0/ }
                };

                const rule = regionRules[region];
                if (!rule) return { error: "Invalid region selected." };

                // Convert input to array of digits
                let digitsArr = partialDigits.trim().split(/\s+/).filter(d => /^\d$/.test(d));
                if (digitsArr.length === 0) return { error: "Please enter digits (0â€“9)." };
                if (digitsArr.length < 6) return { error: "Please enter at least 6 digits." };

                const missing = rule.length - digitsArr.length;
                if (missing < 0) return { error: `Too many digits. Max for ${region.toUpperCase()} is ${rule.length}.` };

                let results = new Set();
                const MAX_RESULTS = 200; // limit to avoid freezing

                // Recursive function to fill missing digits
                function fill(current, remainingSlots) {
                    if (results.size >= MAX_RESULTS) return; // stop when limit reached

                    if (remainingSlots === 0) {
                        const numStr = current.join('');
                        if (rule.startPattern.test(numStr)) {
                            results.add(numStr);
                        }
                        return;
                    }
                    for (let i = 0; i <= 9; i++) {
                        current.push(String(i));
                        fill(current, remainingSlots - 1);
                        current.pop();
                        if (results.size >= MAX_RESULTS) return;
                    }
                }

                fill([...digitsArr], missing);

                return { combos: Array.from(results) };
            }

            document.getElementById('phoneNumberForm').addEventListener('submit', function (event) {
                event.preventDefault();
                const inputString = document.getElementById('inputString').value.trim();
                const region = document.getElementById('region').value;
                const resultData = generateMobileNumbersFromGiven(inputString, region);

                const resultDiv = document.getElementById('result');
                if (resultData.error) {
                    resultDiv.innerHTML = `<div class="text-red-600">${resultData.error}</div>`;
                } else if (resultData.combos && resultData.combos.length > 0) {
                    resultDiv.innerHTML = `
                        <div class="font-semibold mb-2">Combinations Found: ${resultData.combos.length} (showing first ${Math.min(resultData.combos.length, 200)})</div>
                        <div class="max-h-64 overflow-y-auto border p-2 rounded">
                            <ul class="list-disc list-inside space-y-1">
                                ${resultData.combos.map(c => `<li>${c}</li>`).join('')}
                            </ul>
                        </div>
                    `;
                }
            });
        </script>
    </body>
</html>
